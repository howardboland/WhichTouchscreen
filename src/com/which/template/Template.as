package com.which.template{    import com.which.template.events.TemplateEvent;        import fl.text.TLFTextField;        import flash.display.*;    import flash.errors.IOError;    import flash.events.*;    import flash.net.URLLoader;    import flash.net.URLRequest;    import flash.text.*;
    public class Template extends MovieClip    {		        public var headerTLF:TLFTextField;        public var titleTLF:TLFTextField;        public var bodyTLF:TLFTextField;		public var website:String = "";		public var _imageURLs:Array;		public var button:MovieClip;	        protected var body_divider_delta:Number;        protected var body_btn_delta:Number;        protected var btn_delta:Number = 0;		protected var bitmap:Bitmap;		protected var imageIndex:int = 0;        public function Template()        {			if (this.stage)			{				init();			} else {				this.addEventListener(Event.ADDED_TO_STAGE, this.init);			}        }        protected function init(event:Event) : void        {			if (this.hasOwnProperty("btn"))			this.button = this["btn"];			this.headerTLF = this["header"];			this.titleTLF = this["title"];			this.bodyTLF = this["body"];            this.setupButton();			//test();        }				public function setupButton() : void		{			if (this.button!=null)			{				this.btn_delta = this.button.slant.x - (this.button.txt.x + this.button.txt.textWidth);				this.button.mouseChildren = false;				this.button.mouseEnabled = this.button.buttonMode = true;				this.button.addEventListener(MouseEvent.MOUSE_OVER, this.onBtnOver);				this.button.addEventListener(MouseEvent.MOUSE_OUT, this.onBtnOut);				this.button.addEventListener(MouseEvent.CLICK, this.onAction);				this.button.slant.icon.gotoAndStop("man");			}					}				protected function onAction( e:MouseEvent=null ):void		{			trace(website);			this.dispatchEvent( new TemplateEvent( TemplateEvent.OPEN_URL, website ));		}				protected function test():void		{			headerText = "Which? Lorem Ipsum"           	titleText = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. ";			bodyText = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse sed felis ligula. Morbi id arcu id dui porta tristique eu et velit. Duis purus nisi, tempor ut lacus vitae, facilisis eleifend metus. Donec pretium libero eget dignissim porttitor. Integer quis ante vehicula, volutpat quam at, eleifend urna. Morbi ac lectus et sem sodales pellentesque. Sed at tortor nec magna egestas volutpat a sit amet dolor. Quisque odio lectus, malesuada et odio quis, varius vehicula massa. Phasellus a porttitor lacus, ac pretium tortor. Aliquam ac ultrices lectus. Donec volutpat lectus sed orci placerat posuere.";			imageURLs = ["../userdata/random.jpg"];								}				protected function onBtnOver(e:MouseEvent) : void		{			e.target.alpha = 0.8;					}				protected function onBtnOut(e:MouseEvent) : void		{			e.target.alpha = 1;					}		        public function set titleText(s:String) : void        {            this.titleTLF.text = s.toUpperCase();            this.titleTLF.autoSize = TextFieldAutoSize.LEFT;        		}        public function get titleText() : String        {            return this.titleTLF.text;        }        public function set headerText(s:String) : void        {            this.headerTLF.text = s.toUpperCase();            this.headerTLF.autoSize = TextFieldAutoSize.LEFT;        }        public function get headerText() : String        {            return this.headerTLF.text;        }        public function set bodyText(s:String) : void        {            if (isNaN(this.body_divider_delta))            {                this.body_divider_delta =  this.bodyTLF.y + this.bodyTLF.textHeight;            }            if (isNaN(this.body_btn_delta))            {				if (this.button!=null)                this.body_btn_delta =  this.button.y;            }            this.bodyTLF.text = s.toUpperCase();            this.bodyTLF.autoSize = TextFieldAutoSize.LEFT;                   }        public function get bodyText() : String        {            return this.bodyTLF.text;        }               public function set buttonText(s:String) : void        {			            var tf:TLFTextField = this.button.txt;            tf.text = s;            tf.autoSize = TextFieldAutoSize.LEFT;            this.button.slant.x = this.btn_delta + (tf.x + tf.textWidth);            this.button.bg.width = this.button.slant.x + this.button.slant.width;			             }        public function get buttonText() : String        {            return this.button.txt.text;        }		public function set imageURLs(urls:Array) : void        {			if (_imageURLs!=urls)			{				imageIndex = 0				loadImage( urls );			}			_imageURLs = urls;			        }		public function get imageURLs() : Array        {            return _imageURLs;        }				protected function loadImage( urls:Array ):void		{			if (imageIndex<urls.length)			{				var l:Loader = new Loader();				l.contentLoaderInfo.addEventListener(Event.COMPLETE, imageLoaded );				l.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR, imageError );				l.load(  new URLRequest( urls[imageIndex] )  );			}		}				protected function imageLoaded( e:Event ):void		{						var imageHolder:MovieClip = this["imageHolder"+(imageIndex+1)];						bitmap = Bitmap(e.target.loader.content);            bitmap.smoothing = true;			imageHolder.img.bg.visible = false;			var scaleFactor:Number = Math.min(imageHolder.img.bg.width/bitmap.width, imageHolder.img.bg.height/bitmap.height); 			bitmap.scaleX = bitmap.scaleY = scaleFactor;						imageHolder.img.addChild(bitmap);			imageIndex++;			loadImage( this.imageURLs)		}		protected function imageError( e:IOErrorEvent ):void		{			trace(e.text);		}		    }}